---
id: TASK-002
title: 创建武侠小说端到端测试
role: implementer
priority: 1
dependencies: []
---

为当前的测试代码重构为一套完整的端到端测试，要求模拟用户真实的创作过程，生成10章2000字的短篇武侠小说为测试目标，全面测试系统的所有功能。

测试需求：
1. 模拟真实创作流程：初始化项目 -> 创建角色 -> 设定世界观 -> 生成章节 -> 审阅修改 -> 导出成品
2. 测试目标：生成10章，每章约2000字的武侠小说
3. 验证点：
   - 角色一致性（人物设定在各章节保持一致）
   - 情节连贯性（前后章节逻辑连贯）
   - 世界观完整性（武功体系、门派设定等保持统一）
   - API 响应正确性
   - 数据持久化正确性
4. 测试文件位置：project/backend/tests/integration/test_novel_e2e.py
5. 确保测试可以独立运行，不依赖外部状态
6. 测试完成后应清理测试数据

实现要点：
- 使用 pytest fixtures 管理测试数据生命周期
- 模拟前端用户操作序列
- 验证每个步骤的输出
- 记录性能指标（生成时间、token 消耗等）
- 测试通过后输出完整的小说内容到临时文件供人工审阅
