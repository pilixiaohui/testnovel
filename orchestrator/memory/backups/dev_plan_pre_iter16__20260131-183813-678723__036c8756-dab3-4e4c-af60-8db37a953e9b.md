# Dev Plan (Snapshot)

> 本文件由 MAIN 维护。REVIEW FAIL，DEV 修复中。

## 约束（强制）
- 任务总数必须保持在"几十条"以内（少而硬）
- 每个任务块必须包含：`status / acceptance / evidence`
- status 只允许：TODO / DOING / BLOCKED / DONE / VERIFIED
- 只有 **REVIEW 的证据** 才能把 DONE -> VERIFIED

---

## Milestone M1: E2E测试补全（TDD红灯阶段）- 已完成

### M1-T1: P0-图信息提取/提交闭环E2E
- status: DONE
- acceptance:
  - 新建 `project/frontend/tests/e2e/state-extract.spec.ts`
  - 覆盖stateExtract调用、变更预览、stateCommit提交、World刷新
  - 覆盖失败场景与重试
- evidence: TEST Iteration 9 PASS，红灯确认

### M1-T2: P0-章节正文生成E2E
- status: DONE
- acceptance:
  - 新建 `project/frontend/tests/e2e/chapter-render.spec.ts`
  - 覆盖POST /chapters/{id}/render调用与结果展示
- evidence: TEST Iteration 9 PASS，红灯确认

### M1-T3: P1-Step6跳转Editor E2E
- status: DONE
- acceptance:
  - 扩展 `project/frontend/tests/e2e/snowflake.spec.ts`
  - 验证Step6完成后跳转EditorView
- evidence: TEST Iteration 9 PASS，红灯确认

### M1-T4: P2-分支/提交/快照UI E2E
- status: DONE
- acceptance:
  - 新建 `project/frontend/tests/e2e/version-control.spec.ts`
- evidence: TEST Iteration 9 PASS，红灯确认

### M1-T5: P2-章节审核流程E2E
- status: DONE
- acceptance:
  - 扩展 `project/frontend/tests/e2e/core.e2e.spec.ts`
- evidence: TEST Iteration 9 PASS，红灯确认

---

## Milestone M2: 前端实现补齐（TDD绿灯阶段）- REVIEW FAIL，修复中

### M2-T1: P0-图信息提取/提交UI实现
- status: DOING
- acceptance:
  - WorldView/EditorView/SnowflakeView增加提取入口
  - 变更预览diff展示
  - 提交后World刷新
  - M1-T1测试通过（绿灯）
  - **前后端契约一致**
- evidence: REVIEW Iteration 12 FAIL（契约不一致），待修复

### M2-T2: P0-章节正文生成UI实现
- status: DOING
- acceptance:
  - EditorView增加章节渲染入口
  - 调用POST /chapters/{id}/render
  - M1-T2测试通过（绿灯）
  - **使用 rendered_content 字段**
  - **移除占位章节**
- evidence: REVIEW Iteration 12 FAIL（字段不一致+占位章节），待修复

### M2-T3: P1-Step6跳转实现
- status: DOING
- acceptance:
  - SnowflakeView Step6完成后router.push到Editor
  - 传递root_id/branch_id
  - M1-T3测试通过（绿灯）
  - **移除固定 sleep**
- evidence: REVIEW Iteration 12 FAIL（固定sleep），待修复

### M2-T4: P2-分支/提交/快照UI实现
- status: DOING
- acceptance:
  - 补齐BranchList/CommitList组件功能
  - M1-T4测试通过（绿灯）
  - **移除 DEV 伪造数据兜底**
- evidence: REVIEW Iteration 12 FAIL（DEV兜底），待修复

### M2-T5: P2-章节审核流程实现
- status: DOING
- acceptance:
  - 完善审核按钮逻辑
  - M1-T5测试通过（绿灯）
  - **章节来源为真实数据**
- evidence: REVIEW Iteration 12 FAIL（占位章节），待修复
