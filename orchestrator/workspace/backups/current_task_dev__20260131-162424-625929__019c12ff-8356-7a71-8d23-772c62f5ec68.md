# Current Task (Iteration 10)
assigned_agent: DEV
self_test: enabled

## 任务目标
实现前端缺失功能，使E2E测试从红灯转绿灯。按P0优先级实现：
1. 图信息提取/提交闭环UI
2. 章节正文生成入口
3. Step6跳转Editor

## 实现要求

### P0-1: 图信息提取/提交闭环
- 位置：WorldView.vue / EditorView.vue / SnowflakeView.vue
- 功能：
  - 添加"提取图信息"按钮 `[data-test="state-extract"]`
  - 调用 `stateExtract` API（已存在于 `src/api/llm.ts:8`）
  - 展示变更预览diff
  - 添加"提交变更"按钮触发 `stateCommit`
  - 提交成功后刷新World数据（调用entities/anchors/subplots接口）
  - 失败时显示错误提示并提供重试入口

### P0-2: 章节正文生成
- 位置：EditorView.vue
- 功能：
  - 添加章节渲染入口 `[data-test="chapter-render-btn"]`
  - 调用 `POST /chapters/{id}/render`（需在chapter.ts添加API）
  - 展示渲染结果content和quality_scores
  - 失败时显示错误提示并提供重试入口
  - 章节列表项添加 `[data-test="chapter-review-item"]`

### P0-3: Step6跳转Editor
- 位置：SnowflakeView.vue Step6Panel.vue
- 功能：
  - Step6完成后自动跳转到 `/editor`
  - URL携带 `root_id` 和 `branch_id` 参数
  - 使用 `router.push({ path: '/editor', query: { root_id, branch_id } })`

### P1: 章节审核流程
- 位置：EditorView.vue
- 功能：
  - 添加Approve/Reject按钮
  - 调用review API更新状态
  - 状态标签实时更新

### P2: 版本控制UI
- 位置：新建或扩展现有组件
- 功能：
  - 分支列表展示 `[data-test="version-control-root"]`
  - 分支切换功能
  - 提交历史查看
  - 快照加载/恢复

## 验收标准
1. `cd /home/zxh/ainovel_v3/project/frontend && npm run test:e2e` → 15 passed（原7+新8）
2. 所有新增data-test选择器正确添加
3. API调用符合文档规格

## 参考文件
- API封装：src/api/llm.ts, src/api/chapter.ts, src/api/branch.ts, src/api/commit.ts
- 测试用例：tests/e2e/state-extract.spec.ts, chapter-render.spec.ts, version-control.spec.ts
- 文档规格：doc/frontend_implementation_spec.md:457,574,575,754

## 执行环境
- frontend_root: /home/zxh/ainovel_v3/project/frontend
- 测试命令: npm run test:e2e
