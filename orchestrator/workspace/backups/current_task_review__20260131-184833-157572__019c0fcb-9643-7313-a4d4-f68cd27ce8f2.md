# Current Task (Iteration 16)
assigned_agent: REVIEW
review_mode: milestone

## 任务目标
Milestone M2 验收+代码审查：验证前端实现补齐（TDD绿灯阶段）是否完成。

## 验收标准
1. `cd /home/zxh/ainovel_v3/project/frontend && npm run test:e2e` → 15 passed, 0 failed
2. 所有M2任务的acceptance条件均满足

## 代码审查要求

### 实现文件审查
- `project/frontend/src/components/StateExtractPanel.vue` - state_extract/state_commit契约一致性
- `project/frontend/src/views/EditorView.vue` - renderChapter字段、章节数据来源、版本控制
- `project/frontend/src/views/SnowflakeView.vue` - Step6跳转逻辑
- `project/frontend/src/api/llm.ts` - stateCommit API参数
- `project/frontend/src/api/chapter.ts` - ChapterRenderResponse字段

### 测试文件审查
- `project/frontend/tests/e2e/state-extract.spec.ts` - mock契约正确性
- `project/frontend/tests/e2e/chapter-render.spec.ts` - mock完整性
- `project/frontend/tests/e2e/core.e2e.spec.ts` - Step6断言、ChapterReview mock
- `project/frontend/tests/e2e/version-control.spec.ts` - 路由匹配正确性
- `project/frontend/playwright.config.ts` - webServer配置

### 审查重点
1. 前后端契约一致性（state_extract返回StateProposal[]、state_commit参数位置、rendered_content字段）
2. 无占位章节/DEV伪造数据兜底
3. 无固定sleep
4. 测试mock与实现行为一致
5. E2E基础设施统一（端口5185、超时600s）

## M2任务验收清单

### M2-T1: P0-图信息提取/提交UI实现
- [ ] WorldView/EditorView/SnowflakeView增加提取入口
- [ ] 变更预览diff展示
- [ ] 提交后World刷新
- [ ] 前后端契约一致

### M2-T2: P0-章节正文生成UI实现
- [ ] EditorView增加章节渲染入口
- [ ] 使用rendered_content字段
- [ ] 移除占位章节

### M2-T3: P1-Step6跳转实现
- [ ] Step6完成后router.push到Editor
- [ ] 传递root_id/branch_id
- [ ] 移除固定sleep

### M2-T4: P2-分支/提交/快照UI实现
- [ ] BranchList/CommitList组件功能完整
- [ ] 移除DEV伪造数据兜底

### M2-T5: P2-章节审核流程实现
- [ ] 审核按钮逻辑完善
- [ ] 章节来源为真实数据

## 执行环境
- 工作目录: /home/zxh/ainovel_v3
- 代码目录: /home/zxh/ainovel_v3/project/backend
- 前端目录: /home/zxh/ainovel_v3/project/frontend
- Python: /home/zxh/ainovel_v3/project/backend/.venv/bin/python
- 环境变量:
  - MEMGRAPH_HOST=localhost
  - MEMGRAPH_PORT=7687
- 测试执行配置:
  - 前端开发端口: 5185
  - 服务启动等待: 6秒
  - unit测试超时: 120秒
  - integration测试超时: 300秒
  - e2e测试超时: 600秒

