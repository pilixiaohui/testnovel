# Current Task (Iteration 7)
assigned_agent: IMPLEMENTER
self_test: enabled

## 任务目标
修复 SYNTHESIZER 第3次 REWORK 发现的问题：Simulation Scene 流程缺口 + 空断言清理

## 问题清单（来自 SYNTHESIZER Iteration 6 报告）

### P0 - Simulation Scene 功能缺口
1. [TEST_RUNNER] 场景4 `Simulation Step/Scene` 失败：`scene_status=null`，`key_requests.simScene=false`
2. round_status=200 但 scene_status=null，说明推演 round 请求成功但 scene 级别的状态未正确更新或返回
3. 需确保 simulation scene 的完整链路：触发推演 → round 执行 → scene 状态更新 → 前端正确展示
4. mock_suspected=true 提示验证器怀疑存在 mock 数据，需确保真实 API 调用

### P1 - 空断言清理（ANTI_CHEAT 反复命中）
5. [ANTI_CHEAT] 11 个测试文件存在空断言可疑，这是连续3轮被标记的问题
6. 需对这 11 个文件逐一检查，补充有效业务断言或移除无效测试
7. 目标：将空断言可疑数量显著降低，使 ANTI_CHEAT 不再判定 FAIL

## 需求边界
- 输入：当前代码库 + 已有的赛博朋克小说数据
- 输出：修复后的 simulation scene 链路 + 清理后的测试断言
- 行为：
  1. 定位 simulation scene 状态为 null 的根因（前端状态管理？后端 API 响应？路由问题？）
  2. 修复 scene 级别的推演状态链路
  3. 清理 11 个测试文件中的空断言，补充有效断言
  4. 通过浏览器验证 simulation scene 流程正常

## 验收标准（抽象描述）
- Simulation Scene 推演流程正常：scene_status 非 null，simScene 请求可见
- 空断言可疑文件数量显著减少（目标：ANTI_CHEAT 不再 FAIL）
- 单元测试和覆盖率仍然达标
- 浏览器自测 Simulation 全流程（Step + Scene）均正常

## 约束条件
- 空断言清理聚焦被标记的 11 个文件，不要大规模重写
- 修复 simulation scene 时保持最小改动原则
- 确保真实 API 调用，不引入新的 mock
- 提供 mock_suspected 的反驳证据（真实网络请求日志）

## 执行环境
- 工作目录: /home/zxh/ainovel_v3
- 代码目录: /home/zxh/ainovel_v3/project/backend
- 前端目录: /home/zxh/ainovel_v3/project/frontend
- Python: /home/zxh/ainovel_v3/project/backend/.venv/bin/python
- 环境变量:
  - MEMGRAPH_HOST=localhost
  - MEMGRAPH_PORT=7687
- 测试执行配置:
  - 前端开发端口: 5185
  - 服务启动等待: 6秒
  - unit测试超时: 120秒
  - integration测试超时: 300秒
  - e2e测试超时: 600秒

