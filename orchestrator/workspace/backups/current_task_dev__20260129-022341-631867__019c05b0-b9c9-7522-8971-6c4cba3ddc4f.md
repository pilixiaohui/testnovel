# Current Task (Iteration 4)
assigned_agent: DEV
self_test: enabled

## 任务目标
补齐前端类型定义，按 `doc/frontend_implementation_spec.md` 第 2 节规格补全缺失的类型。

## 背景
REVIEW 报告显示前端类型定义缺失 20 个（已实现 21 / 规格 24，但命名不一致）。需按规格统一类型命名并补齐缺失类型。

## 实现要求

### 1. 补齐 types/snowflake.ts（规格 2.1）
确保包含以下类型（若已存在但命名不同，需重命名或添加别名）：
- `SnowflakeRoot`
- `CharacterSheet`
- `SceneNode`
- `Act`
- `Chapter`
- `Step4Result`

### 2. 补齐 types/simulation.ts（规格 2.2）
确保包含以下类型：
- `Desire`
- `Intention`
- `AgentAction`
- `CharacterAgentState`
- `ActionResult`
- `DMArbitration`
- `ConvergenceCheck`
- `SimulationRoundResult`
- `ReplanResult`
- `ReplanRequest`
- `FeedbackReport`

### 3. 补齐 types/entity.ts（规格 2.3）
确保包含以下类型：
- `EntityView`
- `EntityRelationView`
- `StoryAnchor`
- `Subplot`
- `SceneView`
- `SceneContextView`
- `WorldSnapshot`

### 4. 创建 types/index.ts 统一导出
```typescript
export * from './snowflake'
export * from './simulation'
export * from './entity'
export * from './api'
```

### 5. 类型字段要求
每个类型的字段必须与规格文档完全一致，包括：
- 字段名称（使用 snake_case 或 camelCase 需与规格一致）
- 字段类型（string, number, boolean, 数组, 可选字段等）
- 字面量类型（如 `type: 'short_term' | 'long_term' | 'reactive'`）

## 验收标准
必须依次执行以下命令并在报告中汇报每项结果：
1. `grep -c 'export interface SnowflakeRoot' project/frontend/src/types/snowflake.ts` → 应返回 1
2. `grep -c 'export interface CharacterSheet' project/frontend/src/types/snowflake.ts` → 应返回 1
3. `grep -c 'export interface Desire' project/frontend/src/types/simulation.ts` → 应返回 1
4. `grep -c 'export interface CharacterAgentState' project/frontend/src/types/simulation.ts` → 应返回 1
5. `grep -c 'export interface EntityView' project/frontend/src/types/entity.ts` → 应返回 1
6. `grep -c 'export interface StoryAnchor' project/frontend/src/types/entity.ts` → 应返回 1
7. `grep -c 'export interface SceneView' project/frontend/src/types/entity.ts` → 应返回 1
8. `test -f project/frontend/src/types/index.ts && echo 'exists'` → 应输出 exists
9. `cd project/frontend && npm run build` → 构建成功，退出码 0

## 执行环境
- 工作目录: /home/zxh/ainovel_v3
- 代码目录: /home/zxh/ainovel_v3/project/backend
- Python: /home/zxh/ainovel_v3/project/backend/.venv/bin/python
- 环境变量:
  - MEMGRAPH_HOST=localhost
  - MEMGRAPH_PORT=7687

