# Current Task (Iteration 3)
assigned_agent: IMPLEMENTER
self_test: enabled

## 任务目标
修复 SYNTHESIZER REWORK 发现的问题：后端 API 稳定性、需求证据缺口、边界输入处理

## 问题清单（来自 SYNTHESIZER 报告）

### P0 - 核心链路 500 错误
1. [TEST_RUNNER] `/api/v1/roots` 返回 500
2. [TEST_RUNNER] `/api/v1/snowflake/step2`、`step3`、`step4` 返回 500
3. [TEST_RUNNER] Step/Scene 按钮处于 disabled 状态，无法触发交互
4. [TEST_RUNNER] 章节渲染（Render）按钮缺失
5. [EDGE_CASE_TESTER] XSS/SQL注入/Unicode 输入均触发 500（应返回 4xx 或正常处理）

### P1 - 需求证据缺口
6. [REQUIREMENT_VALIDATOR] 主题一致性：需确认生成内容与"名为何方的异世界穿越者穿越到赛博朋克世界的冒险爽文故事"主题一致
7. [REQUIREMENT_VALIDATOR] 章节字数：每章应约2000字，当前证据不足（IMPLEMENTER报告最短3122字符≈约1500字，需核实）
8. [REQUIREMENT_VALIDATOR] TopOne API 超时配置：需提供≥10分钟超时的配置证据（前端axios timeout + 后端httpx timeout）

## 需求边界
- 输入：当前已部署的前后端服务 + 已创建的赛博朋克小说数据
- 输出：稳定可用的 API 链路 + 完整的需求证据
- 行为：
  1. 确保后端服务启动且所有核心 API 正常响应（非 500）
  2. 确保前端界面交互元素（Step按钮、Scene按钮、Render按钮）可用
  3. 验证并提供 TopOne 超时配置≥10分钟的证据
  4. 验证章节字数是否接近约2000字目标
  5. 确保边界输入（特殊字符）不会导致 500

## 验收标准（抽象描述）
- 核心 API（roots、snowflake step1~6、simulation、chapter render）均正常响应
- 前端界面 Step/Scene/Render 按钮可交互
- TopOne 超时配置≥10分钟有明确证据（配置文件或代码截取）
- 章节字数统计接近约2000字目标
- 边界输入不触发 500（返回合理错误或正常处理）
- 通过浏览器完整重新验证创作流程

## 约束条件
- 不要修改已生成的小说内容，只修复基础设施和配置问题
- 如果 500 是因为服务未启动，确保服务稳定运行后再验证
- 如果字数偏差是 LLM 生成特性，记录实际字数并说明原因
- 边界输入处理：优先在后端做输入校验，返回 4xx 而非 500

## 执行环境
- 工作目录: /home/zxh/ainovel_v3
- 代码目录: /home/zxh/ainovel_v3/project/backend
- 前端目录: /home/zxh/ainovel_v3/project/frontend
- Python: /home/zxh/ainovel_v3/project/backend/.venv/bin/python
- 环境变量:
  - MEMGRAPH_HOST=localhost
  - MEMGRAPH_PORT=7687
- 测试执行配置:
  - 前端开发端口: 5185
  - 服务启动等待: 6秒
  - unit测试超时: 120秒
  - integration测试超时: 300秒
  - e2e测试超时: 600秒

