# Current Task (Iteration 11)
assigned_agent: DEV
self_test: enabled

## 任务目标
为Step5b端点添加章节总数约束，确保生成的章节数严格等于10

## 背景
- TEST已创建测试：`project/backend/tests/unit/test_step5b_chapter_count.py`
- 当前红灯原因：Step5b端点未校验章节总数，章节数!=10时仍返回200
- 需要添加约束：总数!=10时快速失败返回400

## 实现要求
1. 在`project/backend/app/main.py`的Step5b端点中添加章节总数校验
2. 调用generate_chapter_list后，统计所有幕的章节总数
3. 如果总数!=10，返回HTTPException(status_code=400, detail="chapter count must be exactly 10")
4. 可选：在LLM提示词中明确要求生成10章（`project/backend/app/llm/prompts/step5b.py`）
5. 保持快速失败原则，不做重试或兜底

## 被修改代码
- `project/backend/app/main.py` - Step5b端点，添加总数校验
- 可选：`project/backend/app/llm/prompts/step5b.py` - 提示词中明确10章要求

## 验收标准
1. `cd project/backend && MEMGRAPH_HOST=localhost MEMGRAPH_PORT=7687 python -m pytest tests/unit/test_step5b_chapter_count.py -v` → 3个测试全部PASS
2. 章节总数=10时返回200和10个章节
3. 章节总数!=10时返回400错误

## 执行环境
- 工作目录: /home/zxh/ainovel_v3
- 代码目录: /home/zxh/ainovel_v3/project/backend
- Python: /home/zxh/ainovel_v3/project/backend/.venv/bin/python
- 环境变量:
  - MEMGRAPH_HOST=localhost
  - MEMGRAPH_PORT=7687

