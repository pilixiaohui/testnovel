# Current Task (Iteration 13)
assigned_agent: DEV
self_test: enabled

## 任务目标
修复 E2E 测试问题（REVIEW 报告的测试问题）

## 问题分析
REVIEW 报告发现以下测试问题：
1. **并发端口冲突**：所有 E2E 测试文件都使用 `127.0.0.1:5177` 启动 devServer，并行执行时端口冲突
2. **mock 路径不一致**：`core.e2e.spec.ts` 监听 `**/api/v1/scene/**` 和 `**/api/v1/world/**`，但 API 客户端实际调用 `**/api/v1/scenes/**` 和 `**/api/v1/roots/**`
3. **断言字段不匹配**：断言 `Hero faces the storm` 但页面渲染的是 `scene.title`

## 修复要求

### 1. 修复并发端口冲突
方案：在 `core.e2e.spec.ts` 中使用不同端口（如 5180）或配置串行执行

### 2. 修复 mock 路径
文件：`project/frontend/tests/e2e/core.e2e.spec.ts`
- 将 `**/api/v1/scene/**` 改为 `**/api/v1/scenes/**`
- 将 `**/api/v1/world/**` 改为 `**/api/v1/roots/**`

### 3. 修复断言字段
确保 mock 数据包含正确的 `title` 字段，或更新断言匹配实际渲染内容

## 验收标准
必须依次执行以下命令并在报告中汇报每项结果：
1. `cd project/frontend && npx playwright test snowflake.spec.ts` → 测试通过
2. `cd project/frontend && npx playwright test simulation.spec.ts` → 测试通过
3. `cd project/frontend && npx playwright test core.e2e.spec.ts` → 测试通过
4. `cd project/frontend && npm run test:e2e` → 全部测试通过

## 执行环境
- 工作目录: /home/zxh/ainovel_v3
- 代码目录: /home/zxh/ainovel_v3/project/backend
- Python: /home/zxh/ainovel_v3/project/backend/.venv/bin/python
- 环境变量:
  - MEMGRAPH_HOST=localhost
  - MEMGRAPH_PORT=7687

