# Current Task (Iteration 10)
assigned_agent: TEST
work_mode: design

## 任务目标
为Step5b章节数量约束编写测试，验证生成的章节总数严格等于10

## 背景
- 用户要求生成10章小说
- 当前Step5b生成逻辑为"每幕3-7章"，无法保证总数=10
- 需要添加约束确保总章数严格等于10
- 不满足时应快速失败返回400

## 测试需求
1. Step5b生成的章节总数必须等于10
2. 章节数量不足10时返回400错误
3. 章节数量超过10时返回400错误
4. 正常情况下返回10个章节结构

## 被测代码
- 后端端点：`project/backend/app/main.py` Step5b端点
- LLM引擎：`project/backend/app/services/llm_engine.py` generate_chapter_list
- 提示词：`project/backend/app/llm/prompts/step5b.py`

## 验收标准
1. `cd project/backend && python -m pytest tests/unit/test_step5b_chapter_count.py -v` → 测试文件存在，测试可运行
2. 测试覆盖：章节数=10通过、章节数!=10返回400

## 执行环境
- 工作目录: /home/zxh/ainovel_v3
- 代码目录: /home/zxh/ainovel_v3/project/backend
- Python: /home/zxh/ainovel_v3/project/backend/.venv/bin/python
- 环境变量:
  - MEMGRAPH_HOST=localhost
  - MEMGRAPH_PORT=7687

