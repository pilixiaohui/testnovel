# Current Task (Iteration 6)
assigned_agent: IMPLEMENTER
self_test: enabled

## 任务目标
SYNTHESIZER 验证结论 BLOCKED，发现大量问题需要修复。

## 验证器发现的问题清单（必须全部处理）

### 1. 后端API返回500（TEST_RUNNER FAIL）
- `/api/v1/roots` 返回 500
- `/settings/llm` 返回 500
- `/snowflake/step1` 返回 500
- 其他多个核心API返回500
**要求**：检查后端API端点实现，修复导致500的bug。重点检查：
  - 后端路由是否正确注册
  - 数据库连接是否正常（Memgraph）
  - API handler中的异常处理
  - 请求参数格式是否匹配

### 2. 硬编码URL和代码质量问题（ANTI_CHEAT FAIL）
- 前端代码中存在硬编码URL
- 测试中存在空断言（expect() 无实际检查）
- 代码中存在TODO注释未处理
- 运行时Mock数据残留
**要求**：
  - 将硬编码URL替换为环境变量或配置
  - 修复空断言，添加实际检查逻辑
  - 处理或删除TODO注释
  - 清理运行时Mock残留

### 3. 关键需求未覆盖（REQUIREMENT_VALIDATOR FAIL）
- 项目保存/管理功能缺失或无证据
- 标签页切换功能无证据
- 图信息提取与推演功能无证据
- 10章验收测试未执行
**要求**：确保这些功能在代码中实际实现（不仅仅是类型修复）

### 4. 前端服务不可访问（EDGE_CASE BLOCKED）
- http://127.0.0.1:5185 ERR_CONNECTION_REFUSED
**要求**：
  - 确保前端dev server可以正常启动
  - 检查vite.config.ts中的host/port配置
  - 确保端口5185未被占用

## 工作优先级
1. 先修复后端API 500问题（这是所有前端功能的基础）
2. 修复前端服务启动问题
3. 清理硬编码URL、空断言、TODO、Mock残留
4. 确保关键功能实际可用

## 验收标准
- 后端核心API（/roots、/settings/llm、/snowflake/step1等）返回正常响应（非500）
- 前端dev server可在5185端口正常启动
- 无硬编码URL（使用环境变量或配置）
- 无空断言
- 无运行时Mock残留
- 前端构建通过 + 全量单测通过
- 关键功能（项目管理、雪花流程、推演、设置）在代码层面实际实现

## 约束
- 后端修复限于API handler层面的bug fix，不做架构变更
- 前端修复聚焦实际功能实现，不仅仅是类型修复
- 每个修复都要有对应测试验证

## 执行环境
- 工作目录: /home/zxh/ainovel_v3
- 代码目录: /home/zxh/ainovel_v3/project/backend
- 前端目录: /home/zxh/ainovel_v3/project/frontend
- Python: /home/zxh/ainovel_v3/project/backend/.venv/bin/python
- 环境变量:
  - MEMGRAPH_HOST=localhost
  - MEMGRAPH_PORT=7687
- 测试执行配置:
  - 前端开发端口: 5185
  - 服务启动等待: 6秒
  - unit测试超时: 120秒
  - integration测试超时: 300秒
  - e2e测试超时: 600秒

