# Current Task (Iteration 14)
assigned_agent: TEST
work_mode: design

## 任务目标
为章节渲染持久化编写集成测试，验证rendered_content写入Memgraph并可通过GET获取

## 背景
- M2-T2已完成章节渲染API，渲染后会调用update_chapter持久化
- 需要验证持久化链路完整：渲染后的内容确实写入Memgraph
- 需要验证读取链路：GET /api/v1/chapters/{id}返回rendered_content

## 测试需求
1. 渲染章节后，rendered_content被持久化到Memgraph
2. GET /api/v1/chapters/{chapter_id}返回包含rendered_content字段
3. 多次渲染同一章节，rendered_content被更新
4. 未渲染的章节，rendered_content为null或空

## 被测代码
- 渲染端点：`project/backend/app/main.py` POST /chapters/{id}/render
- 获取端点：`project/backend/app/main.py` GET /chapters/{id}（如存在）
- 存储层：`project/backend/app/storage/memgraph_storage.py` update_chapter/get_chapter

## 验收标准
1. `cd project/backend && python -m pytest tests/integration/test_chapter_persistence.py -v` → 测试文件存在，测试可运行
2. 测试覆盖：渲染后持久化验证、GET返回rendered_content、更新覆盖验证

## 执行环境
- 工作目录: /home/zxh/ainovel_v3
- 代码目录: /home/zxh/ainovel_v3/project/backend
- Python: /home/zxh/ainovel_v3/project/backend/.venv/bin/python
- 环境变量:
  - MEMGRAPH_HOST=localhost
  - MEMGRAPH_PORT=7687

