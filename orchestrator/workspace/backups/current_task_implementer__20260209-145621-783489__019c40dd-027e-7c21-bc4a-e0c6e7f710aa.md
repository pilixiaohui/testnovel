# Current Task (Iteration 3)
assigned_agent: IMPLEMENTER
self_test: enabled

## 任务目标
前两轮迭代仅修复了2个小问题（step4上下文同步、EditorView scene_id同步），8个用户报告的核心问题几乎都未触及。本轮必须批量调研并修复所有剩余问题。

## 严格要求：本轮必须覆盖以下所有问题

不要每轮只修一个点。请在本轮内完成以下所有问题的调研和修复。

### 1. 项目保存与新建（P0）
- 检查 HomeView 新建项目流程：API调用、路由跳转、projectStore初始化
- 检查 projectStore.saveProject / setProject 的完整保存链路
- 确保创建项目后能正确跳转到雪花页面并携带项目上下文

### 2. 雪花步骤内容完整显示（P0）
- CharacterCard、SceneCard、ActCard、ChapterCard 目前只显示名字列表
- 必须显示完整字段：角色的 ambition/conflict/epiphany/voice_dna，场景的 expected_outcome/conflict_type，幕的 purpose/tone，章的 focus/word_count 等
- 检查 snowflakeStore 是否正确存储了完整数据
- 检查各 Card 组件的 template 是否渲染了所有字段

### 3. 原始信息和解析结果显示（P0）
- 需要支持查看 LLM 返回的原始文本（raw_output）和解析后的结构化数据
- 检查 snowflakeStore 是否保存了 raw_output
- 在 SnowflakeView 或各 Step Panel 中添加原始结果查看功能

### 4. 提示词显示实际值（P1）
- 检查提示词编辑/查看功能是否从后端 API 获取实际使用的提示词
- 而非使用前端硬编码的默认值
- 检查 llmApi 或 snowflakeApi 中是否有获取提示词的接口

### 5. 设置页 LLM 配置（P1）
- SettingsView 应从后端获取真实的 LLM 配置（模型名、端点、API key状态等）
- 检查是否有对应的后端 API 接口
- 确保显示的是数据库中的真实配置而非前端默认值

### 6. 标签页切换（P1）
- 检查各 View（SnowflakeView/SimulationView/EditorView/WorldView/SettingsView）的 onMounted/watch 逻辑
- 确认切换时状态正确初始化，不会因缺少上下文而报错
- 检查路由守卫是否正确处理了项目上下文

### 7. 图信息提取与推演（P1）
- 检查 StateExtractPanel 和 llmApi.stateExtract 的调用链
- 检查 SimulationView 和 simulationApi 的调用链
- 确保前端正确调用后端 API 并处理响应

## 工作方式
- 对每个问题：先阅读相关代码确认问题是否属实，再修复
- 每个修复写对应的单元测试
- 最后运行全量前端单元测试确认无回归

## 验收标准
- 以上7类问题全部调研并修复（或确认不存在）
- 前端全量单元测试通过
- 前端构建无报错

## 约束
- 本轮必须覆盖所有7类问题，不能只修1-2个
- 遵循现有技术栈和代码风格
- 不改变后端 API 接口（除非发现后端 bug）

## 执行环境
- 工作目录: /home/zxh/ainovel_v3
- 代码目录: /home/zxh/ainovel_v3/project/backend
- 前端目录: /home/zxh/ainovel_v3/project/frontend
- Python: /home/zxh/ainovel_v3/project/backend/.venv/bin/python
- 环境变量:
  - MEMGRAPH_HOST=localhost
  - MEMGRAPH_PORT=7687
- 测试执行配置:
  - 前端开发端口: 5185
  - 服务启动等待: 6秒
  - unit测试超时: 120秒
  - integration测试超时: 300秒
  - e2e测试超时: 600秒

