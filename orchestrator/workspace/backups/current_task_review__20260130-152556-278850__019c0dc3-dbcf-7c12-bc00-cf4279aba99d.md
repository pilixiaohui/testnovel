# Current Task (Iteration 2)
assigned_agent: REVIEW
review_mode: single

## 任务目标
验收M2-T2章节渲染API字数约束功能

## 验收范围

### M2-T2: 章节渲染API（/chapters/{id}/render）
- 验收命令: `cd project/backend && python -m pytest tests/integration/test_chapter_render_api.py -v`
- 预期: 全部PASS
- 实现文件: `project/backend/app/main.py`（约120行字数统计函数，约600行渲染接口）
- 测试文件: `project/backend/tests/integration/test_chapter_render_api.py`

## 代码审查要求（必做）

### 1. 字数约束实现检查
- 字数统计函数`_count_rendered_chars`是否正确实现
- 统计口径是否合理（去除标点空白）
- 1800-2200字范围校验是否正确
- 不达标时是否返回400错误
- 错误信息是否包含实际字数便于调试

### 2. 测试代码合理性检查
- 测试是否覆盖正常范围（1800-2200）
- 测试是否覆盖边界条件（<1800, >2200）
- 测试是否验证400错误响应
- 是否存在作弊测试（mock过度导致未测真实逻辑）

### 3. 代码质量检查
- 快速失败原则是否遵守
- 是否有硬编码魔法数字（1800/2200应有常量或注释说明）
- 异常处理是否完整

## 验收标准
1. 验收命令全部PASS
2. 字数约束逻辑正确实现
3. 测试覆盖充分无作弊
4. 代码质量符合项目规范

## 执行环境
- 工作目录: /home/zxh/ainovel_v3
- Python: /home/zxh/ainovel_v3/project/backend/.venv/bin/python
