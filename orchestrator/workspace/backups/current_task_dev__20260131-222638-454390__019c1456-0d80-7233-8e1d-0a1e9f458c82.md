# Current Task (Iteration 21)
assigned_agent: DEV
self_test: enabled

## 任务目标
完善M3-T3真实接口E2E测试，使其在有后端时能稳定通过

## 当前问题
- `real-api.spec.ts` 用例1失败：`page.waitForResponse` 15s超时
- 原因：真实后端未运行或响应慢

## 修改方向
1. 调整测试策略：真实接口测试应检测后端是否可用，不可用时优雅跳过
2. 增加后端健康检查：测试前先检查 `/api/v1/health` 或类似端点
3. 调整等待时间：真实LLM请求可能需要更长时间，考虑使用更长的等待窗口
4. 或改为验证请求已发出（不依赖响应成功）

## 验收标准
1. `cd project/frontend && npx playwright test real-api.spec.ts --list` → 列出测试用例
2. `cd project/frontend && npx playwright test real-api.spec.ts` → mock模式下跳过或通过
3. 测试代码包含后端可用性检查逻辑

## 执行环境
- 工作目录: /home/zxh/ainovel_v3
- 代码目录: /home/zxh/ainovel_v3/project/backend
- 前端目录: /home/zxh/ainovel_v3/project/frontend
- Python: /home/zxh/ainovel_v3/project/backend/.venv/bin/python
- 环境变量:
  - MEMGRAPH_HOST=localhost
  - MEMGRAPH_PORT=7687
- 测试执行配置:
  - 前端开发端口: 5185
  - 服务启动等待: 6秒
  - unit测试超时: 120秒
  - integration测试超时: 300秒
  - e2e测试超时: 600秒

