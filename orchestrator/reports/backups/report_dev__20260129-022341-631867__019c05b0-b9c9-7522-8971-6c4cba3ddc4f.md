已阅读开发行为规范  
iteration: 4  
self_test: enabled  

## 任务理解

工单要求实现的功能：
1. 按规格补齐 `types/snowflake.ts`、`types/simulation.ts`、`types/entity.ts` 的缺失类型与字段。
2. 创建 `types/index.ts` 统一导出入口。
3. 修复因类型变更引起的编译报错，确保 `npm run build` 通过。

## 实现方案

### 设计思路
以规格文档为唯一来源补齐类型，新增的规范类型与现有业务类型通过别名保持最小改动；对受影响的视图/Store/类型对齐测试做必要同步，保证严格类型下可编译。整体遵循 KISS（直接按规格定义字段）与 DRY（用别名复用已有命名）。

### 改动说明

| 文件 | 修改内容 | 实现逻辑 |
|-----|---------|---------|
| `project/frontend/src/types/snowflake.ts:1` | 补齐 2.1 规格类型并新增 `SnowflakeRootState` | 按规格定义字段，使用别名兼容旧命名 |
| `project/frontend/src/types/simulation.ts:1` | 补齐 2.2 全部类型并定义 `SimulationConfig` 别名 | 以 `SimulationRoundResult` 为核心结构复用 |
| `project/frontend/src/types/entity.ts:1` | 补齐 2.3 全部类型并保留现有实体类型 | 新增规格类型，不破坏既有 `WorldEntity` |
| `project/frontend/src/types/index.ts:1` | 新增统一导出入口 | 满足工单导出要求 |
| `project/frontend/src/stores/snowflake.ts:11` | 使用 `SnowflakeRootState` 作为 Store 状态类型 | 避免与规格 `SnowflakeRoot` 冲突 |
| `project/frontend/src/views/SnowflakeFlow.vue:49` | 更新角色/场景渲染字段 | 与 `CharacterSheet`、`SceneNode` 字段对齐 |
| `project/frontend/src/__tests__/fe_api_types_store_alignment.test.ts:7` | 调整类型对齐测试引用 `SnowflakeRootState` | 与新的 Store 状态类型一致 |

### 关键实现逻辑
- 数据流向：`SnowflakeRoot` 作为 API 结构类型；Store 状态使用 `SnowflakeRootState`，避免字段冲突。
- 关键处理步骤：先按规格定义类型 → 用别名兼容旧命名 → 同步 Store/视图使用字段。
- 异常处理策略：不新增兜底逻辑，保持快速失败。
- 与其他模块交互：`types/index.ts` 统一导出，供后续模块按需引用。

## 自测结果（仅 enabled 模式）

### 验收结果汇总

| 序号 | 命令 | 返回码 | 结果摘要 |
|-----|------|-------|---------|
| 1 | `grep -c 'export interface SnowflakeRoot' project/frontend/src/types/snowflake.ts` | 0 | 1 |
| 2 | `grep -c 'export interface CharacterSheet' project/frontend/src/types/snowflake.ts` | 0 | 1 |
| 3 | `grep -c 'export interface Desire' project/frontend/src/types/simulation.ts` | 0 | 1 |
| 4 | `grep -c 'export interface CharacterAgentState' project/frontend/src/types/simulation.ts` | 0 | 1 |
| 5 | `grep -c 'export interface EntityView' project/frontend/src/types/entity.ts` | 0 | 1 |
| 6 | `grep -c 'export interface StoryAnchor' project/frontend/src/types/entity.ts` | 0 | 1 |
| 7 | `grep -c 'export interface SceneView' project/frontend/src/types/entity.ts` | 0 | 1 |
| 8 | `test -f project/frontend/src/types/index.ts && echo 'exists'` | 0 | exists |
| 9 | `cd project/frontend && npm run build` | 0 | `vue-tsc` + `vite build` 成功 |

- 全部验收命令已执行: 是  
- 自测结果: PASS  

### 测试详情
构建成功，无 TypeScript 错误。

结论：PASS  
阻塞：无  

【MCP调用简报】
服务: serena  
触发: 读取规格并补齐类型定义、同步相关代码  
参数: read_file/create_text_file/replace_regex/insert  
结果: 类型补齐与编译通过  
状态: 成功