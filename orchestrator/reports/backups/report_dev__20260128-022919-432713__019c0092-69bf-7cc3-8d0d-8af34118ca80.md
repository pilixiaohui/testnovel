已阅读开发行为规范
iteration: 7
self_test: enabled

## 改动说明

### 改了哪里
- `project/frontend/src/api/index.ts:3` - 为 apiClient 增加超时与请求/响应拦截器入口
- `project/frontend/src/api/snowflake.ts:11` - 补齐 step1-step6 接口封装并标注 step6 对应后端 step5b
- `project/frontend/src/types/snowflake.ts:1` - 增补 Snowflake 结构/载荷类型并加入 current_step 字段
- `project/frontend/src/stores/snowflake.ts:4` - Store 状态对齐新增 current_step

### 为什么这样改
- 对齐 M2-T1：统一超时与拦截器配置入口，保持最小且透明的请求链路（KISS/快速失败）。
- 对齐 M2-T2：补齐 step1-step6 端点封装，避免分散调用与重复逻辑（DRY）。
- 对齐 M2-T3：类型与 Store 同步新增 current_step，保持结构一致（SRP）。
- step6 后端对应 step5b，直接在封装处标注映射，避免隐式约定。

## 自测结果（仅 enabled 模式）

- 验收命令: `rg -n 'timeout' /home/zxh/ainovel_v3/project/frontend/src/api/index.ts` | 返回码: 0 | 输出: `5:  timeout: 15000,`
- 验收命令: `rg -n 'interceptors' /home/zxh/ainovel_v3/project/frontend/src/api/index.ts` | 返回码: 0 | 输出: `8:apiClient.interceptors.request.use((config) => config)`; `9:apiClient.interceptors.response.use(`
- 验收命令: `rg -n 'step1' /home/zxh/ainovel_v3/project/frontend/src/api/snowflake.ts` | 返回码: 0 | 输出: `12:  apiClient.post<string[]>('/api/v1/snowflake/step1', { idea })`
- 验收命令: `rg -n 'step2' /home/zxh/ainovel_v3/project/frontend/src/api/snowflake.ts` | 返回码: 0 | 输出: `15:  apiClient.post<SnowflakeStructure>('/api/v1/snowflake/step2', { logline })`; `18:  apiClient.post<SnowflakeRoot>('/api/v1/snowflake/step2', { logline })`
- 验收命令: `rg -n 'step3' /home/zxh/ainovel_v3/project/frontend/src/api/snowflake.ts` | 返回码: 0 | 输出: `21:  apiClient.post<SnowflakeCharacter[]>('/api/v1/snowflake/step3', root)`
- 验收命令: `rg -n 'step4' /home/zxh/ainovel_v3/project/frontend/src/api/snowflake.ts` | 返回码: 0 | 输出: `24:  apiClient.post<SnowflakeStep4Result>('/api/v1/snowflake/step4', payload)`
- 验收命令: `rg -n 'step5' /home/zxh/ainovel_v3/project/frontend/src/api/snowflake.ts` | 返回码: 0 | 输出: `27:  apiClient.post<Array<Record<string, unknown>>>('/api/v1/snowflake/step5a', payload)`; `30:  apiClient.post<Array<Record<string, unknown>>>('/api/v1/snowflake/step5b', payload)`
- 验收命令: `rg -n 'step6' /home/zxh/ainovel_v3/project/frontend/src/api/snowflake.ts` | 返回码: 0 | 输出: `29:// step6 uses step5b endpoint`
- 验收命令: `rg -n 'steps' /home/zxh/ainovel_v3/project/frontend/src/types/snowflake.ts` | 返回码: 0 | 输出: `49:  steps: SnowflakeStructure[]`
- 验收命令: `rg -n 'current_step' /home/zxh/ainovel_v3/project/frontend/src/types/snowflake.ts` | 返回码: 0 | 输出: `50:  current_step: number`
- 验收命令: `rg -n 'steps' /home/zxh/ainovel_v3/project/frontend/src/stores/snowflake.ts` | 返回码: 0 | 输出: `8:    steps: [],`
- 验收命令: `rg -n 'current_step' /home/zxh/ainovel_v3/project/frontend/src/stores/snowflake.ts` | 返回码: 0 | 输出: `9:    current_step: 1,`
- 测试通过数: 12 passed
- coverage: 0%
- 自测结果: PASS

## 总结与展望
- 已完成核心任务：API Client 超时/拦截器配置、Snowflake step1-step6 封装、类型与 Store 对齐 current_step。
- 原则应用：保持 API 层最小职责、无额外兜底逻辑（KISS/YAGNI）；通过统一类型与封装减少重复（DRY）。
- 遇到挑战：后端未提供 step6 端点，使用 step5b 显式映射并标注说明。
- 下一步建议：如需更严格契约，可单独引入后端 SnowflakeRoot 类型并完善前端状态转换。

结论：PASS
阻塞：无

【MCP调用简报】
服务: serena
触发: 读取/修改前端 API、类型与 Store 并执行验收命令
参数: read_file/search_for_pattern/create_text_file/replace_regex/execute_shell_command（max_answer_chars=-1, cwd=/home/zxh/ainovel_v3/project/backend）
结果: 更新 4 个文件；12 条验收命令全部通过
状态: 成功