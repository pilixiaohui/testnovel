已阅读开发行为规范
iteration: 6
self_test: enabled

## 任务理解

工单要求实现的功能：
1. 修复 EditorView 的 renderScene 调用，补齐 SceneRenderPayload 必填字段。
2. 确保 5 个字段取值非空，满足后端校验。
3. 如上下文缺失字段，从 store 或合理默认值中构造。

## 实现方案

### 设计思路
- 在前端集中构造渲染 payload，复用同一逻辑供 “加载场景自动渲染” 与 “手动渲染” 使用，减少重复（DRY/KISS）。
- 优先读取场景上下文与 store 值，必要时提供最小合理默认值，确保字段非空并快速失败（YAGNI/快速失败）。

### 改动说明

| 文件 | 修改内容 | 实现逻辑 |
|-----|---------|---------|
| `project/frontend/src/views/EditorView.vue:81` | 新增渲染上下文缓存与 payload 构造函数 | 从上下文与 store 提取字段，必要时使用合理默认值保证必填字段非空 |
| `project/frontend/src/views/EditorView.vue:173` | renderScene 调用改为传入完整 payload | load/render 场景时统一使用 buildRenderPayload 结果 |

### 关键实现逻辑
- 数据流向：`fetchSceneContext` → 缓存上下文 → `buildRenderPayload` 组装 payload → `renderScene`。
- 关键处理步骤：优先读取 `voice_dna/conflict_type/outline_requirement/user_intent/expected_outcome`，缺失时回退到 store/默认值，保证非空。
- 异常处理策略：沿用现有 try/catch，未新增兜底逻辑，保持快速失败风格。
- 与其他模块交互：仅调整 EditorView 调用参数，不改变 API 签名与后端逻辑。

## 自测结果（仅 enabled 模式）

### 验收结果汇总

| 序号 | 命令 | 返回码 | 结果摘要 |
|-----|------|-------|---------|
| 1 | `MEMGRAPH_HOST=localhost MEMGRAPH_PORT=7687 /home/zxh/ainovel_v3/project/backend/.venv/bin/python -m pytest project/backend/tests/unit/test_render_contract.py -v` | 0 | 8 passed, 2 warnings |

- 全部验收命令已执行: 是
- 自测结果: PASS
- 覆盖率: 未输出（未开启覆盖率参数）

### 测试详情
- `tests/unit/test_render_contract.py` 全部通过。
- 警告：FastAPI `on_event` deprecation（不影响本次验收）。

## 测试问题反馈（如有）

无

结论：PASS
阻塞：无

【MCP调用简报】
服务: serena
触发: 定位并修改 EditorView 的 render payload 逻辑
参数: search_for_pattern/read_file/replace_regex（relative_path=project/frontend/src/views/EditorView.vue）
结果: 完成 payload 组装与 renderScene 调用更新
状态: 成功