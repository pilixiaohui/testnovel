已阅读开发行为规范
iteration: 8
self_test: enabled

## 任务理解

工单要求实现的功能：
1. 补齐缺失单测文件 `test_schema_anchor.py/test_schema_agent.py/test_schema_simulation.py`。
2. 覆盖 Pydantic 模型与 GQLAlchemy schema 字段/默认值一致性，并通过验收测试。

## 实现方案

### 设计思路
复用现有 `schema_contract_helpers` 与 `models_contract_helpers`，为 Anchor/Agent/Simulation 三个领域分别补齐 schema 字段、索引、默认值，以及 Pydantic 字段/默认值对齐检查，保持测试结构与既有 `test_schema_act_chapter.py` 风格一致。

### 改动说明

| 文件 | 修改内容 | 实现逻辑 |
|-----|---------|---------|
| `project/backend/tests/unit/test_schema_anchor.py` | 新增 StoryAnchor 的 schema/模型对齐测试 | 校验字段、索引、默认值与 Pydantic 对齐 |
| `project/backend/tests/unit/test_schema_agent.py` | 新增 CharacterAgentState 的 schema/模型对齐测试 | 校验字段、索引、默认值与 Pydantic 对齐 |
| `project/backend/tests/unit/test_schema_simulation.py` | 新增 SimulationLog 的 schema/模型对齐测试 | 校验字段、索引、默认值与 Pydantic 对齐 |

### 关键实现逻辑
- 数据流向：schema_contract_helpers 提供 schema 校验 → models_contract_helpers 提供 Pydantic 校验 → 对比字段集合与默认值。
- 关键步骤：分别校验 schema 模型存在性/显式 label、字段集合、索引定义与默认值；再校验 Pydantic 模型字段覆盖与默认值一致。
- 异常处理策略：无兜底，缺失即直接失败（快速失败）。
- 与其他模块交互：仅新增测试文件，不修改业务逻辑或依赖。

## 自测结果（仅 enabled 模式）

### 验收结果汇总

| 序号 | 命令 | 返回码 | 结果摘要 |
|-----|------|-------|---------|
| 1 | `MEMGRAPH_HOST=localhost MEMGRAPH_PORT=7687 PATH=/home/zxh/ainovel_v3/project/backend/.venv/bin:$PATH pytest -q /home/zxh/ainovel_v3/project/backend/tests/unit/test_schema_anchor.py` | 0 | 6 passed |
| 2 | `MEMGRAPH_HOST=localhost MEMGRAPH_PORT=7687 PATH=/home/zxh/ainovel_v3/project/backend/.venv/bin:$PATH pytest -q /home/zxh/ainovel_v3/project/backend/tests/unit/test_schema_agent.py` | 0 | 6 passed |
| 3 | `MEMGRAPH_HOST=localhost MEMGRAPH_PORT=7687 PATH=/home/zxh/ainovel_v3/project/backend/.venv/bin:$PATH pytest -q /home/zxh/ainovel_v3/project/backend/tests/unit/test_schema_simulation.py` | 0 | 6 passed |

- 全部验收命令已执行: 是
- 自测结果: PASS
- 覆盖率: N/A（验收命令未包含覆盖率输出）

### 测试详情
三项验收测试全部通过，无失败项。

## 测试问题反馈（如有）

无

结论：PASS  
阻塞：无

【MCP调用简报】
服务: serena  
触发: 读取 schema/models 以及创建缺失单测并执行验收  
参数: read_file/create_text_file/execute_shell_command  
结果: 新增 3 个测试文件；验收测试全部通过  
状态: 成功